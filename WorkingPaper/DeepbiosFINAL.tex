\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[left=2.00cm, right=2.00cm]{geometry}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{natbib}
\usepackage{comment}
\usepackage[most]{tcolorbox}
\newcommand{\Zu}[1]{\textcolor{blue}{\rm{Zu cmmt:} #1 \rm}}
%\usepackage[style=authoryear-icomp,sorting=anyt]{biblatex}

%\addbibresource{Biblio_deepbios.bib}
%\graphicspath{C:\Users\Rodrigo\Desktop\Papers_ON GOING\TREE_Modelling}

\begin{document}
\title{Sustainability discovery in eco-evolutionary diversification-inspired federated networks}%Title as in the FET EU proposal

\maketitle
\noindent \author{Rodrigo Riera$^{1,2,*}$, Ali Vadathi$^{3}$, Francisco Bald\'o$^{4}$, Gian Marco Palamara$^{5,6}$, Oskar Hagen$^{7}$, Pengjuan Zu$^{y}$, Victor M. Egu\'iluz$^{z}$, and Carlos J. Meli\'an$^{8,9}$}
            \\
    %Discuss with David Alonso${^6}$ and Joaqu\'in Hortal${^7}$ about authorship
    %Potential coauthors: %JON NORBERG -- PAULO GUIMARAES
            
            \vspace{0.25 in}
            
  \noindent  $^{1}$IU-ECOAQUA, Departamento Biolog\'ia, Universidad de Las Palmas de Gran Canaria, Canary Islands, Spain\\
  $^{2}$Departamento de Ecolog\'ia, Facultad de Ciencias, Universidad Cat\'olica de la Sant\'isima Concepci\'on, Concepci\'on, Chile\\
  $^{3}$, Department of XX, University of Zurich, Switzerland\\
  $^{4}$Instituto Español de Oceanografía (IEO), C.O. de Cádiz, Cádiz, Spain\\
  $^{5}$Department of Systems Analysis, Integrated Assessment and Modelling, Eawag Center for Ecology, Evolution and Biogeochemistry, Switzerland\\
  $^{7}$German Centre for Integrative Biodiversity Research (iDiv), Halle-Jena-Leipzig, Deutscher Platz 5e, Leipzig 04103, Germany\\
  %$^{6}$Theoretical and Computational Ecology, Center for Advanced Studies of Blanes, Girona, Spain\\
  %$^{7}$Departamento de Biogeograf\'ia y Cambio Global, MNCN, Madrid, Spain\\
  $^{8}$Department of Fish Ecology and Evolution, Eawag, Centre of Ecology, Evolution and Biogeochemistry, Switzerland\\
  $^{9}$ Institute of Ecology and Evolution, Aquatic Ecology, University of Bern, Baltzerstrasse 6, CH-3012, Bern, Switzerland.\\
\vspace{0.25 in}

  $^{*}$corresponding author: rodrigo.riera@ulpgc.es

\newpage
\section{Abstract}
\begin{enumerate}

\item Identifying the coupling between trait diversification and ecosystem exploitation is critical to understand the fate of Earth systems. 
\item Yet, connecting large biodiversity datasets to human activities in federated networks, that is, networks in which many different groups of species, humans and technologies coexist, to infer causal links and novel sustainability paths remains at a very incipient stage.  
\item We provide an approach to infer causal and discovery sustainability paths combining Bayesian graphs and knowledge informed neural networks (KINN) in exploited ecosystems.
\item We tested the validity of our method with a marine ecosystem: Theory, empirical data and experiments suggest that fishing drives changes in maturation age, genotypic and phenotypic diversity. However, determining whether trait changes are the result of fisheries-induced evolution and how changes alter sustainability paths in large and species-rich ecosystems have been difficult to test.
\item \textcolor{red}{We introduce the julia package XYZ}. The metrics that our package provides will allow to infer the coupling among trait diversification, ecosystem exploitation and coexistence to discover sustainability paths at the interface of species-rich exploited ecosystems.
\end{enumerate}



\begin{comment}
\Zu{In general, I feel there are many terms in abstract that are not easy to get their real meanings without giving proper explanations, and it is not very obvious to get the relations/connections of these terms. As commented in the text: what is 'biological-human interactions'; what is 'earth and environmental dynamics'; why one is fine-grained and the other is coarse-grained; what does this to do with 'Biodiversity science' here.\\
Perhaps the logic flow can be: 1) the complexity of ecosystems (incl. different layers/scales of ecosystem compositions (static), and different factors that influence ecosystem dynamic). 2) the importance and challenges in predicting (projecting to future) and understanding (mechanistically) ecosystem (as Fig. 3). 3) the key questions and innovation of the project: aim to figure out how knowledge (for prediction and understanding) changes along different gradients of complexity? A sustainable workflow/technique on how to process data --> knowledge --> applications (promote more sustainable ecosystems). This developed technique is sustainable because it is automated, and output can be updated when feeding new data (it evolves with data).)\\
This is what I understand about from reading the manuscript and the discussion today. Maybe there are some other points I have missed.}


The merging of pattern- and process-based methods and the building
of theory to merge knowledge and predictive power is not taken
place. Theories play a pivotal role in providing explanations to
what, at first, might seem to be a series of disconnected, even
paradoxical, patterns. We provide here a framework connecting
synthesis between pattern- and process-driven research. Our approach
integrates deep learning networks with process-based methods, i.e. deep
process-based learning network to infer patterns and processes
underlying large and integrated databases. We show a case study
using a deep process-based learning network to explore the strength of
coupling between layers and the dimensionality in Biodiversity and
Environmental databases. We validate our approach with a case study focusing on the sustainability of the ocean in federated networks, where many heterogeneous groups of species, humans, and technologies coexist exploiting resources in complex ecosystems. Merging process-based approaches and
data-driven deep learning networks might play a critical role in
deciphering the strength of the coupling between Earth and
biodiversity systems in rapidly changing landscapes. Lastly, this project not only sets out to deliver novel computational sustainability approaches but also provides fully reproducible open-source software solutions of a science-enabled technology to connect knowledge-inspired societies to global sustainability challenges.
\end{comment}

\newpage

\section{Introduction}
Human footprint is pervasive worldwide \citep{marconcini2020outlining, mcdowell2020pervasive}. Deciphering biodiversity patterns in such an untouched wilderness to ensure ecosystem conservation and halting habitat loss and fragmentation \citep{brum2017global} requires synthesis connecting biodiversity to ecosystem exploitation data and sustainability metrics. Despite that unraveling the linkages among physico-chemical processes, environmental drivers, internal regulatory processes at the population, community, and ecosystem levels and the role of human intervention is essential for effective management and sustainability \citep{hobbs2011intervention}, the connection among species-rich ecosystems, humans, exploitation technologies and sustainability has not been explored in detail yet. Recent studies have shown that the interactions within and between organizational levels (i.e., ) can result in complex dynamical behavior including sudden shifts in ecosystem states and extinction patterns of populations and communities \citep{newman2019scaling}. \textcolor{red}{Theories play a pivotal role in providing explanations to what, at first, might seem to be a series of disconnected, even paradoxical, patterns. For example, trait diversification, biodiversity patterns and exploited ecosystem belong to different classes of theories, yet the understanding of the coupling among them can help to provide unexplored sustainability paths. Here we aim to build a framework to explore the strength of coupling between trait diversification and biodiversity patterns in exploited ecosystems. Our approach integrates Bayesian graphs with process-based deep learning networks, i.e. deep process-based learning networks to infer the coexistence and trait diversification patterns connected to sustainability paths in exploited ecosystems. We show a case study using a knowledge informed neural network, the KINN, to show how the strength of coupling between trait diversification and ecosystem exploitation in large biodiversity datasets might play an important role in understanding sustainability of ecosystems.}

Biodiversity science has expanded in a wide range of disciplines throughout the last decades \citep{loreau2010challenges}. Fortunately, the integration of biodiversity databases to decipher the sustainability properties of exploited ecosystems can produce a more unified biodiversity science. In this regard, exploited ecosystems need to be addressed from a broad-scale and synthesis perspective, because of the complexity of biological systems concerning the description and prediction of biodiversity patterns and processes accounting for genes, individuals, communities, and ecosystems across temporal and spatial scales \citep{chase2018embracing}, as well as, their implications on current and future societal challenges such as climate change, human health, and poverty \citep{cardinale2012biodiversity, turner2012global}. In 2015, 17 Sustainable Development Goals (SDGs) were set by the United Nations. These SDGs identify current global problems that are shared across the globe and require an immediate solution. The implementation of SDGs requires a local-to-global framework that provides a global yet local plan of action. Computational sustainability thinking can help to contribute to such a framework for problem-solving through processes that are suitable at a local-scale and then scale up towards broad spatiotemporal scales. The applicability of computational approaches as a real-world sustainability problem-solving tool is still quite incipient \citep{rabiee2017abstraction} and further research is needed to develop modelling approaches providing environmental-sustainable solutions for global-shared and local-specific ecosystems.

\textcolor{red}{Connecting exploited ecosystems to biodiversity maintenance is calling for technologies to discover novel ways of sustainable exploitation. For example, novel technologies for data integration from different fields, {\it i.e.}, environmental, social, biodiversity and Earth science data, can uncover new patterns, causal relationships and new paths to reach sustainable exploitation while maintaining biodiversity and coexistence in species-rich ecosystems}. This is of paramount importance since the patterns observed in the collapse of ecosystems are usually driven by disruptive interactions among different agents, sectors, and the spatio-temporal scales governing biodiversity dynamics. Major technological advances in data integration via omics, i.e. genomics, transcriptomics, proteomics, metabolomics, among others, are providing new tools to improve our understanding of biodiversity patterns \citep{craven2019evolution}. Bayesian networks and deep neural networks are also promising to advance the connection between data integration and sustainability discovery for the maintenance of species-rich ecosystems. Advances in sustainability discovery and data integration target knowledge-based societies that place great expectations on data-driven intelligent machines to face global sustainability challenges. In this regard, database integration to facilitate the discovery of sustainable paths in resource exploitation, the major feature of computational sustainability, is a major issue revolving around data-driven intelligent machines and knowledge-based societies \citep{Gomesetal2019}. 

\textcolor{red}{There are still considerable limitations regarding the integration of data and modelling approaches, especially those concerning the (i) connections between oversimplified simple models and more realistic counterparts, and (ii) computational constraints when developing complex and realistic models. There have recently been fast improvements in methods delivering explainable and complex models integrating heterogeneous data, and also, these models challenge the limits to computational speed to deliver robust conclusions \citep{rodrigues2014integrative}. There is still a long way to go through interdisciplinary fields that promote synergies among societal, economic, and environmental resources within the framework of sustainability. Therefore, integrating data, causality and novel discovery paths to connect exploitation and sustainability criteria in complex ecosystems can assist both policy makers and researchers to determine the most useful type of research at different stages of scaling up processes. This process is of paramount importance to avoid failure of initiatives to influence the society, and the "know-do gap" - the gap between what is known in research and what gets implemented \citep{catford2009advancing}.}

\textcolor{red}{The integration of models ranging from simple models to deep learning complex models will expand the reach of an intervention to new settings or target groups and is accompanied by a systematic strategy to achieve this objective \citep{milat2014increasing}. Yet, scarce studies deal with frameworks, approaches and methods for effective scale-up interventions \citep{wigboldus2013towards, yamey2012barriers}. The integration of deep learning networks with process-based methods providing evidence-to-practice frameworks is pivotal for policy makers, practitioners and stakeholders to scale up global interventions. Computational sustainability is an interdisciplinary discipline that needs to be built from a federated network, potentially more powerful than centralized ones. Many computational sustainability problems require making decisions through time. Solving these problems involves maximizing the expected reward by finding the most suitable that can generate future hypotheses without considering the simulator to run. Another approach consists of the recently developed "stochastic computers" \citep{borders2019integer}, energetically more efficient than conventional ones, and perform faster and more complex calculations. Yet, complex and integrative computational analyses are laborious and extremely time-consuming \citep{rodrigues2014integrative}, especially those related to big data involved in deep learning approaches. Several alternatives have been recently developed such as the development of off-policy evaluation using the Model Free Monte Carlo (MFMC) method \citep{fonteneau2010model}.}

\textcolor{red}{Here we aim to explore model complexity gradients using Bayesian networks and knowledge informed neural networks (KINN) to uncover relations among the data and novel interactions targeting sustainable paths (see Table and methods). Our approach has the potential to integrate process- and pattern-based models from simple to more complex ones accounting for a wide range of resources, {\it i.e.}, diverse prey communities, environmental factors and the technologies used to exploit resources and the economic or societal impacts. We use marine ecosystem data as a case study (methods). Theory and experiments suggest that fishing drives changes in maturation age, genotypic and phenotypic diversity. However, determining whether changes in the wild are the result of fisheries-induced evolution and how changes alter sustainability in large and species-rich ecosystems have been difficult to test \cite {Pinskye2025453118}.}


\begin{comment}
Our genomic findings complement conclusions from literature reviews and evolutionary modeling that, from a management perspective, the direct impacts of fisheries on population abundances and ecosystems are a more pressing concern than the effects of fisheries-induced evolution (12, 19). 

Avoidance of overfishing and reduction of fishing pressure when population abundances become low therefore remain a key management strategy.

Rapid evolution in response to human predation has been inferred from phenotypic change in a wide range of species (2), but genomic evidence from the wild has been substantially more limited (13). 

Here, we tested for rapid evolution from standing genetic variation in the widely cited case of Atlantic cod. The evidence suggested no loss of standing genetic variation and a lack of major genomic change in the wild, in strong contrast to the genomic responses observed in laboratory experiments. 

Our results highlight the necessity of continued focus on understanding how, when, and for which species evolutionary rescue and rapid evolution in the wild do or do not occur.

%Ole Seehausen, June 2 2021 
from Barth et al 2017 
a series of recent studies employing genomewide data to dissect Atlantic cod population differentiation, discovered exceptionally large chromosomal rearrangements that are likely to be inversions on several linkage groups (LGs), which were suggested to play a major role for the adaptive abilities of Atlantic cod (Barney et al., 2017; Berg et al., 2015, 2016; Bradbury et al., 2013, 2014; Hemmer-Hansen et al., 2013; Kirubakaran et al., 2016; Sodeland et al., 2016). These recent studies, including this study, therefore contribute remarkable examples in the marine environment to a growing body of literature identifying chromosomal rearrangements and inversions as an important mechanism to maintain contrasting ecotypes in intermixing populations (Cheng et al., 2012; Hoffmann & Rieseberg, 2008; Joron et al., 2011; Lowry & Willis, 2010). 
here is a paper on the western Atlantic: Barney, B. T., Munkholm, C., Walt, D. R., & Palumbi, S. R. (2017). Highly localized divergence within supergenes in Atlantic cod (Gadus morhua) within the Gulf of Maine. BMC Genomics, 18, 271. 

Trans-oceanic genomic divergence of Atlantic cod ecotypes is associated with large inversions PR Berg1,2, B Star1, C Pampoulie3, IR Bradbury4,5,6, P Bentzen6, JA Hutchings1,6,7, S Jentoft1,8 and KS Jakobsen1 Chromosomal rearrangements such as inversions can play a crucial role in maintaining polymorphism underlying complex traits and contribute to the process of speciation. In Atlantic cod (Gadus morhua), inversions of several megabases have been identified that dominate genomic differentiation between migratory and nonmigratory ecotypes in the Northeast Atlantic. Here, we show that the same genomic regions display elevated divergence and contribute to ecotype divergence in the Northwest Atlantic as well. The occurrence of these inversions on both sides of the Atlantic Ocean reveals a common evolutionary origin, predating the 4100 000-year-old trans-Atlantic separation of Atlantic cod. The long-term persistence of these inversions indicates that they are maintained by selection, possibly facilitated by ... 
...coevolution of genes underlying complex traits. Our data suggest that migratory behaviour is derived from more stationary, ancestral ecotypes. Overall, we identify several large genomic regions—each containing hundreds of genes—likely involved in the maintenance of genomic divergence in Atlantic cod on both sides of the Atlantic Ocean. Heredity (2017) 119, 418–428; doi:10.1038/hdy.2017.54; published online 20 September 2017 
\end{comment}

\textcolor{red}{Bayesian networks provide a way to calculate the joint probability distribution of variables succinctly and computationally feasible \citep{pearl2011bayesian}. Conditional probabilities of Bayesian networks are pivotal to calculate fitting data. A subset of Bayesian networks is Causal Bayesian networks (CBNs), where the relationship between variables is causal. There are algorithms to automatically discover a class of causal relationships between variables that best match the data. Combining automatic causal discovery algorithms and expert knowledge, we can find relationships among variables that are new and informative. Bayesian networks have been explored maintaining the same number of nodes and links. However, nodes are changing entities that can predict better estimations to the empirical patterns. Diversification of biological systems offers here an unexplored avenue for inspiration of new computational approaches. However, diversifying ecosystems are not used for sustainability discovery yet, despite the rapid changes of traits and interactions observed in overexploited, experimental and theoretical systems \citep{Hairston2005, Walsh2006, Fussmann2007, Trugman8532}. Biological systems are characterized by feedbacks between the ecology and evolution of interacting traits, the eco-evolutionary feedbacks, to produce novel traits with new functionalities \citep{Govaertetal2019}. This results in new computational properties, like new cooperation and competition strategies and information processing capabilities. Diversification usually occurs in heterogeneous ecosystems with limited resources where many distinct groups need to develop specialized traits and strategies to obtain resources. The outcome is the formation of consortia and more broadly federated networks composed of phylogenetically and ecologically distinct groups. Conventional Artificial Intelligence (AI) is rapidly moving towards explainable and discovery pattern inference \citep{Iten2020a} but often avoids evolutionary diversification for exploring new computing capabilities \citep{Real2020}. The same situation occurs for artificial neural networks that also make limited use of novel computing capabilities as a consequence of new interactions and traits \citep{Schmidhuber:2015}.}


\begin{comment}
The goal of this project is to implement eco-evolutionary diversification-inspired solutions to perform computational sustainability discovery based on rapidly diversifying traits and interactions. The exploitation of emerging interactions, strategies and traits will allow us to create novel discovery solutions for natural ecosystems facing sustainability challenges like overexploitation of the ocean, where harvesting renewable resources are beyond the diminishing returns for many species and ecosystem resources \citep{Paulyetal1998, Mastrangelo2019}. Why should we go deeper into diversifying networks for computational sustainability? With connections and traits represented in a spatially distributed network, as found in natural ecosystems, diversification is an avenue to harvest renewable resources because most innovations in ecosystems are connected to new sensing and information processing cues to detect and exploit resources. This allows considering not only evolutionary processes changing traits and agents (i.e., plasticity and other sources of variation), but the formation of new entities to quantify new scenarios for sustainability that substantially deviate from evolutionary computation considering only changes and not diversification processes. This also allows representing real-time solutions for ever-changing renewable resources, which is a key problem in many digital and natural systems. We here show a case study using a deep process-based learning network to explore the strength of coupling between layers and the dimensionality in Biodiversity and Environmental databases. We test this approach with a case study focusing on ocean sustainability in federated networks, where species, humans, and technologies coexist exploiting resources in complex and rapidly changing seascapes. To show the capabilities of the approach, we will address full reproducibility, automation, visualization, and reporting (Figure 1). Data integration, causality and diversity may provide a new technology to improve ecosystem sustainability relevant to community-rich digital and natural ecosystems.

%\begin{tabular}%[leftmargin=2cm]

\begin{enumerate}%[\hspace{-0.0 in}(G1)]
%\setlength\itemsep{-0.3em}
   % \vspace{-0.15 in}
    \item To extend existing theories of eco-evolutionary diversification and AI-inspired solutions to decipher the factors driving sustainability discovery in federated networks. This will allow us to identify novel solutions for ecosystem sustainability.
% \vspace{-0.15 in}
    \item To investigate how spatio-temporal evolutionary diversification and AI-inspired networks mimic the empirical patterns of natural and socio-technological ecosystems when heterogeneous human groups, technologies, and species coexist.
% \vspace{-0.15 in}    
    \item To develop fast, reproducible and automated eco-evolutionary diversification-inspired sustainability discovery prototypes for real-time information processing tasks.
% \vspace{-0.15 in}    
    \item To obtain principles of sustainability discovery for prediction in federated networks when diversification in interactions and traits occurs in a large and heterogeneous set of species, technologies and human groups. 
\end{enumerate}

\end{comment}

\textcolor{red}{Taking into account many changing factors to understand complex and large datasets (Figure 1 and Table X) present many challenges. First, biodiversity data is typically scarce and biased (\citep{hortal2015seven}). Although an increasing number of ecological datasets are available, most, if not all, of them are of uneven coverage and quality (Table 1). Second, many patterns have emerged with conflicting explanations usually depending on the spatial and temporal scales of the observations (see Figure 1 and Table 2). Lastly, progress in biodiversity sustainability relies on unifying different theories and datasets in order to explain as many natural patterns with as few principles as possible. Also, merging methods from distinct disciplines can increase our predictive understanding power to develop and test new theory (\citep{reichstein2019deep}). Here we take on a composite of approaches to fully integrate empirical data and theory, particularly through guiding the attention of researchers onto integrating datasets to account for several biological levels and spatio-temporal scales \citep{melian2018deciphering}, \citep{poisot2019data}.}

%Make better flow between computational sustainability and data, causal, and discovery knowledge graphs -- make clear the case study (fish data from North Sea, state clear!!!)

\textcolor{red}{Recent approaches in ecology and evolution have introduced deep learning methods for labelled data, from which selection modes and demographic history can be jointly inferred \citep{sheehan2016deep}. The fusion of models coming from AI and theory in biodiversity research would shed light on process-based scenarios of biodiversity sustainability for large datasets. Yet, most approaches applying deep learning or network methods in biodiversity have mostly focused on one level of biological organization, {\it e.g.}, genes, species or communities, without considering the interaction among them nor the interactions with technological traits and human-disturbances on ecosystems. Also, these studies are single-focused and limited to taxonomic diversity, with no consideration of other emerging diversity dimensions \citep{weiss2019unifying}. Biological systems are composed of many layers (Figure 1), and they can contain interdependent hierarchies and feedbacks with interacting learning entities within and between layers. The number of layers needed for predicting and understanding biological patterns still remains overlooked. This is specifically complex in the Anthropocene, with the widespread role of human-driven disturbances. Bayesian network models connected to deep process-based models accounting for several layers and interactions within and between the layers are going to be important to maintain sustainable ecosystems in the long-term \citep{fontaine2011ecological}, \citep{melian2018deciphering}, \citep{reichstein2019deep}). Data science and biological systems share pivotal properties, but their full potential has not been sufficiently explored \citep{schmidhuber2015deep}. Therefore, exploring deep learning network topologies accounting for feedbacks within and between layers is a first step towards understanding biodiversity dynamics using deep process-based learning networks.}

\section{Methods}

We introduce data, causal and discovery inference to gain understanding of our sustainability of the ocean case study (Figure 1). We can generate knowledge graphs at three different levels: (1) data knowledge graph (what we see), where we gain knowledge by summarising/categorising what we have observed. (2) Causal knowledge graphs (why we see what we see), where we aim to uncover the underneath mechanisms and explain what we observed in data knowledge graphs. (3) Discovery knowledge graph (what we haven't seen), where we try to discover novel knowledge from unobserved data (e.g. by employing theoretical reasoning and/or simulations).

%Examples of the three levels above 
%\Zu{Following are added based on discussion with Carlos on 2nd March}\\
%"Computational sustainability aims to identify, formalize, and provide solutions to computational problems concerning the balancing of environmental, economic, and societal needs for a sustainable future". Gomes et al 2019
% I feel our computational sustainability is different from it(?)

%\Zu{Here we could also add a few examples to explain what we mean for each level. One potential example is Darwin's hawkmoth where based on data knowledge graph (flower with long spur pollinated by long-tongue insect, short spur with short-tongue insect), and causal knowledge graph (nectar in flower spur as a reward for pollinator. a co-evolution case of spur length and insect tongue size), Darwin predicted (can we call it discover knowledge graph?) a super long-tongue insect as pollinator (later known as Xanthopan moth, be discovered 20 years after the prediction) when he only saw an orchid specimen with super long spur. Can also add other examples in different context (phenotype \& genetic control; maybe also one involve social-ecological effects as in our fishery case study}

%Here we aim to connect causal to discovery knowledge graphs. We connect probabilistic graph methods (i.e., causal Bayesian networks, CBNs) to deep neural networks to generate biology informed neural networks, BINNs. First, we explain how we obtain the CBNs from the empirical data. Second, we outline the mechanistic modeling as universal ordinary differential equations (or partial differential equations) and use the CBNs as priors in the mechanistic modeling approach along a gradient of complexity (i.e., we use first the simplest graph and continue adding dimensions to the modeling). Third, we run a simple two species case study to infer the biotic interactions and the underlying functions governing the dynamics.

\subsection{Causal Bayesian networks}
Sustainable ecosystems are complex ones that incorporate several parameters and heterogeneity across levels. Deciding which level of complexity best captures real ecosystems for understanding sustainability is a major challenge today. We use CBNs as prior information to obtain biology informed neural networks and connect them to our sustainability case study. CBNs are a class of probabilistic graphical models (PGMs), powerful tools for mixing available data (from computer simulations, experiments, and expert knowledge) to gain a comprehensive understanding of a complex ecosystem. An advantage of CBNs is that they provide probabilistic answers taking into account the uncertainties in data collection and outputs. In CBNs are directed acyclic graphs (DAG) that show causation between parameters. They allow us to explore the effect of changing one parameter on parameters that are connected to it directly and indirectly. 

Most studies of data discovery focus on advanced analytics functions to gain insights, almost completely ignoring the heterogeneity of data sources \citep{azeroual2019solving}. Currently, only a few databases are semantically annotated from many data sources, e.g. gene ontology database (\citep{gene2021gene}), COVID-19 (e.g. https://www.who.int/emergencies/diseases/novel-coronavirus-2019/global-research-on-novel-coronavirus-2019-nco), among others. Ontology development is time-consuming and requires expert knowledge. It is also paired with data-driven research that checks the soundness of the ontology as it simultaneously seeks discovery. Unfortunately, software tools for mapping and linking different ontologies accounting for many data sources are at a very incipient stage of development \cite{nsf,KGcovid19,Oavida}. Evolutionary-based functions are of utmost importance to find datatype properties from ontologies and raw-data from biodiversity databases. Computational science is pivotal to explore algorithms to gain an understanding of the replicability of data heterogeneity contrasting different evolutionary algorithms. We here use computational approaches to explore the sustainability of the ocean database started in 1965 and currently containing 9 million entries, 1,612 species (i.e., 50 variables and traits per species), around 20 countries and 11 sampling methods (ref of database) (Figure 2).
\\
\begin{itemize}
    \item backwards to the causality literature in networks
    \item which algorithms have been used? How about evolutionary algorithms? and Evolutionary diversification algorithms?
\end{itemize}

Causal discovery from observable data has been extensively studied \citep{Rackauckas2020}. Many of these studies have used symbolic reconstruction of equations by symbolic regressions or evolutionary methods \citep{Koza1992, quade2016prediction, tanevski2020combinatorial}. A common gap in the literature is one where parameters represent eco-evolutionary diversification processes, and thus, discovery can be explored broadly. The classical view on biology-inspired information processing technologies is to consider plasticity without structural changes, or without diversification among many interacting components \citep{DARWISH2018231}. Recent experimental evolution studies show that rapid trait changes with new information processing capabilities are far more complex because adaptation and speciation occur even in sympatry forming new species and phenotypes \citep{Seehausen2014}. For example, eco-evolutionary dynamics strongly affect feedbacks between ecological and evolutionary processes, which influences trait changes to open new structural changes with new information capabilities \citep{Govaertetal2019}. Furthermore, recent studies suggest that the interplay between trait dimensionality, the covariance structure among traits, and adaptation is key to understand the emergence of new traits and information processing abilities to form novel computational sustainability discovery strategies in ecosystems \cite{zora172044}.\\

%So much novelty here -- lets see how far we go 
Eco-evolutionary diversification algorithms will be extended to deep process-based learning networks including traits and interactions driven by evolutionary changes to understand patterns in these systems. The search for causal knowledge discovery will be applied to the data knowledge discovery generated for the sustainability of the ocean, the largest realm on Earth and key actor of climate change affecting biogeochemical and physical processes. 

%Modeling such systems requires tools such as agent-based models integrating data from many fields. ABMs can show emergent properties and many of the features of a system that are often absent in analytical models. A drawback of ABMs is that they are computationally expensive. Therefore, methods making a continuum from analytical models to ABMs are required to quantitatively evaluate the pros and cons of both approaches. Analyzing ABMs needs exploring a large parameter space, which is usually not feasible. A workaround for this limitation is building emulators, which are mathematical formulations (machine learning models) that can estimate the complex behavior of a simulation given different inputs. We can use either traditional machine learning algorithms or deep learning for this endeavour. Traditional ML algorithms have limited predictive power and may not be able to predict complex high-dimensional data. Deep learning is often the choice when there is a large number of training samples. But such a large number of samples are not easy to produce when a single simulation run takes long. A solution to this problem is to find an optimal deep learning architecture. This has been shown to replace complex simulations with very few input data (\cite{Kasim2020}). There are different optimization methods for finding the best architecture (\cite{Elsken2018}). Here, we explore architectures with different degrees of complexity aiming to unify analytical to ABMs scenarios to understand the paths to sustainable ecosystems. 

%EMERGING HETEROGENEOUS DATA, different sources, time series, geographic areas. Federated networks will be used to integrate all data regardless their nature/heterogeneity, etc.

%Emulators are required when our available data is incomplete. This may occur in two scenarios, (i) When we are producing simulated data and those simulations are too time-consuming to explore all parameter combinations; (ii) When we have experimental data that are hard to gather and do not cover all possible parameter combinations. Emulators can predict how the system (computational or real) would behave with new parameter values. These predictions would then be valuable to create knowledge graphs to answer sustainability questions (i.e., finding discovery paths that improve sustainability in the exploitation of the ecosystem).

\subsection{Knowledge informed neural networks}

\\
\begin{itemize}
    \item cite refs showing the ideal of discovery
    \item is our discovery different from the classical drug discovery? If so, why?
\end{itemize}

Technologies in digital ecosystems around federated networks are rapidly increasing and mostly focus on decentralization, scalability and security fronts \cite{Androulaki2018,OceanProtocolFoundation2018,BigchainDBGmbH2018}. Yet, the implementation of eco-evolutionary diversification algorithms and their application to forecasting in global sustainability problems is still lacking. Recent studies have shown the importance of evolutionary search of mathematical and symbolic operations as building blocks to discover ML algorithms \citep{Real2020,Guimera2020}. Eco evolutionary diversification algorithms will help to decipher how interactions among heterogeneous groups evolve and learn to solve complex sustainability problems. Evolutionary dynamics explore open-ended languages of models with varying trait evolution functions to discover biologically inspired solutions in multidimensional systems \citep{Real2020} accounting for heterogeneous agents to discover novel biology-inspired solutions for the sustainability of the ocean federated network. Our understanding of the outcomes from diversified information processing systems formed by highly heterogeneous groups, a kind of large-scale meta-learning in the federated setting \citep{Dilley2016}, is currently quite limited. Therefore, new science-enabled approaches accounting for diversifying information processing in heterogeneous and highly dimensional systems are required. This allows the development of science-enabled technologies where heterogeneous agents with different interests find (non-optimal) solutions for the sustainable exploitation of ecosystems. Federated objects can be seen as ``neural networks'' containing many types of heterogeneous nodes with varying degrees of learning, connectivity and firing probabilities \citep{Maass2014,Maass2015}.

In this section we use the CBNs obtained from the data, the biological and ecological information contained in the data, to exploit recent developments in automatic differentiation \citep{margossian2019review} to differentiate neural networks with respect to their input parameters and functions to obtain biology-informed neural networks \citep{lagergren2020biologically}. We outline the mechanistic modeling as universal ordinary differential equations for the two species interaction scenario (or partial differential equations) as

(describe the equations)

.... where 

The CBNs contains many factors but we start with the simplest graph as a proof of concept to explore the effect of the dimensionality of the information contained in the data to explore how the fitting changes with the information priors. We explore two scenarios. First, we fit static parameter values to the empirical data (i.e., give the meaning of the parameters) given by the spatiotemporal distribution of the two species. Second, we let the parameters to evolve during the dynamics to represent the case of changing traits, for example, changing demographic parameter of the population as fishing pressures increases (refs). We infer in the two scenarios the biotic interactions and the underlying functions governing the dynamics. The generalization of the mechanistic modeling for a larger BINN containing species-rich ecosystems, like the one from the sustainability of the ocean dataset, is described in Box 1. 

Interpretation of the results with and without trait changes ...\\
The outcome of the analysis provides the weights $W_{ij}$ between pairs of nodes in the graph. The interpretation of the weights is the importance of variable $i$ in variable $j$. one possible goal is to extract connections in the marine food web. That is, fishing species $A$ affects positively or negatively species $B$. This food web can be compared with existing marine food webs and assess the performance of the approach, for example, the number of trophic interactions that we are able to capture. (A critique: do we need fishing activity to extract food webs? Probably we can come with a improve goal involving human activity.) 

\subsection{Case study: Sustainability of the Ocean}

Heterogeneous biodiversity data collected by many different countries is a good example for understanding open-problems in science-enabled technologies in federated networks. Many international programs for ocean sustainability involve many countries collecting biodiversity data. We use a large dataset from DATRAS (the Database of Trawl Surveys), which stores data collected primarily from research bottom trawl fish surveys coordinated by the International Council for the Exploration of the Sea (ICES). With the possibility for instant remote access (https://www.ices.dk/data/data-portals/Pages/DATRAS.aspx), the data from DATRAS are used for stock assessments and fish community studies by the ICES community and public users. 

The data used contain occurrences with traits (6,968,083 records) of 484 fish species (136 families, 40 orders) collected in 65,730 hauls carried out in 15 bottom trawl survey time series. The survey data cover the Baltic Sea, Skagerrak, Kattegat, North Sea, English Channel, Celtic Sea, Irish Sea, Bay of Biscay and the eastern Atlantic from the Shetlands to the Gulf of Cadiz. These data were collected over 56 years by institutions of 18 countries using 74 research vessels and 34 different types of gears for scientific purposes, hence commercial and non-commercial species were collected. The result of using different vessels and gears is that heterogeneous and biased data are collected on the same species. This makes it difficult to obtain accurate species distribution maps. This situation can be accentuated if different countries have commercial interests in different species (case study Figure).

casestudy figure caption: The Irish Ground Fish Survey (IE-IGFS, Orange) and the Spanish Survey on the Porcupine Bank (SP-PORC, Blue) were part of the 2018 International Bottom Trawl Survey (Left), coordinated by the International Council for the Exploration of the Sea (ICES, 2019). Ireland and Spain use different Gears: The GOV gear has a larger vertical opening (Ireland, 3-4 m) respect to the Baka used on the Porcupine Bank (Spain, 2-3 m). This makes catchability different depending on the species, such as haddock (\textit{Melanogrammus aeglefinus}, Center) and megrim (\textit{Lepidorhombus whiffiagonis}, Right), in which both countries have different commercial interests. Haddock is a species of the cod family, highly prized in northern Europe, while megrim is a species of flatfish, consumed largely in Spain and France. Spain catches megrim better than haddock and viceversa for Ireland. This generates a strong bias in the distribution maps (compare Megrim \textit{vs.} Haddock map).

ICES (2019) International Bottom Trawl Survey Working Group (IBTSWG). ICES Scientific Reports, 1:60. 159 pp. doi: 10.17895/ices.pub.5596


\section{Discussion}

\subsection{Challenges and future research directions}


\section{Tables}

\begin{table}[]
\begin{center}
\hspace{-0.8 in}\begin{tabular}{ |  p{2.6cm} | p{5cm} | p{4cm} | p{3cm} | }
\hline 
{\bf Term} & {\bf Definition} & {\bf Examples} & {\bf References} \tabularnewline
\hline 
Artificial Intelligence & the simulation of human intelligence in machines that are programmed to think and act like humans  & Digital Assistants, Robots, Face recognition & REFS \tabularnewline
\hline 
 Computational sustainability & Discovery of novel routes combining computational methods and integrated interdisciplinary databases & Fisheries management, circular economy, blue carbon, wildlife corridors &  \tabularnewline
\hline 
Federated networks & Graphs characterized by heterogeneous groups of species,
humans, and technologies coexist exploiting resources & NOAA/ESRL Federated Aerosol Network, federated computer networks &  \tabularnewline
\hline 
Simple model and experiment & A method deliberately simplistic used to explain a mechanism concisely & Climate models, Niche modelling & \tabularnewline
\hline 
 Complex model & A method deliberately overloaded to explore the dimensionality of a system & Ecopath, Ecosim, Climate change models, Food webs & \tabularnewline
\hline 
Deep learning & A model containing more than thousands of parameters simultaneously & Landscape and animal recognition, Image caption generation & \tabularnewline
\hline 
Explainability (Interpretability) & Methods to decipher the causal processes underlying the interactions within the model &  & \tabularnewline

\hline
\end{tabular}
\caption{Glossary of terms}
\end{center}
 \end{table}

\begin{table}[htbp]
	\centering
	\caption{\textcolor{red}{4. This must be a much larger sample and maybe to be added to the SI in future versions: Examples of databases containing information about
          uneven coverage and quality of ecological and environmental
          data}}
      \begin{tabular}{|l|l|l|}
                \hline
		\multicolumn{3}{|c|}{Database} \\
        \hline
               \textbf{Link to database} & \textbf{Taxa} & \textbf{Limitations} \\ \hline
		$https://knb.ecoinformatics.org/$ & Many & Geographic and taxa bias \\
		$https://www.polardata.ca/pdcinput/$ & Many & Polar latitudes \\
		$https://www.mbr-pwrc.usgs.gov/bbs/$ & Birds & North America and Canada \\
		$http://www.iobis.org/$ & Plankton & Atlantic Ocean \\
		$http://globalants.org/$ & Ants & Geographical bias \\
		$http://data.g-e-m.dk/log-in/data-tables/$ & Many & Greenland \\
		\bottomrule
	\end{tabular}%
	
	\label{tab:addlabel}%
\end{table}%

\newpage
    
\section{Figures}

\vspace{-0.5 in}
\begin{figure}[H]
	 \centering
	 \includegraphics[width = 0.5\textwidth]{Fig0.pdf}\\
	 \includegraphics[width =0.6\textwidth]{plots/network_structure.pdf}
	 \caption{Computational sustainability is at the intersection of data, causality and discovery knowledge graphs. Data knowledge graphs introduce data fusion and semantics to disparate databases. Causality knowledge graphs make inferences about the processes explaining the empirical patterns observed in the data knowledge graphs. Discovery knowledge graphs find novel paths not observed in the empirical patterns but of relevance to increase sustainability.}
\end{figure}   

\begin{figure}[H]
	 \centering
	 \includegraphics[width = 0.75\textwidth]{casestudy.pdf}
	 \caption{Computational sustainability applied to the sustainability of the Ocean case study combining many species, human groups and technologies. Top left) Zoomed in is the Irish Ground Fish Survey (IE-IGFS, Orange) and the Spanish Survey on the Porcupine Bank (PORC, Blue). Countries produce strong bias in the distributions maps because they use different Gears according to their commercial interest (Compare Megrim vs. Haddock samplings). Bottom) Each country, species and technology is composed of many nodes: a country contains fishery, environmental agencies, stakeholders, etc. A species contains size-classes, habitat preference, species interactions, etc. Red and blue links mean competition and cooperation links connecting each pair of nodes.}
\end{figure}

\begin{figure}[H]
	 \centering
	 \includegraphics[width = 1\textwidth]{Fig1.png}
	 \\
	 \caption{CAPTION TO BE INCLUDED}
      \end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width = 1\textwidth]{Fig2.png}
	\caption{Integration between models (M1-M4) and datasets (D1-D4). As model complexity increases (i.e., Realism) models produce more testable outputs but generality and tractability might decrease.}
\end{figure}

\newpage

\section{Box}

\vspace{0.25 in}
{\small \begin{tcolorbox}[colback=green!5!white,colframe=green!75!black]
  \textbf{Box 1: Open challenges in computational sustainability}. \\Connecting data, causal and discovery knowledge using eco-evolutionary diversification algorithms to understand the sustainability of the ecosystems is full of challenges. Here, we propose a framework to inspire data-causal-discovery synthesis in computational sustainability. The following five items are rooted in the fact that ecosystem patterns greatly vary in time and space and that most data is scattered within and among fields. With this in mind, what are the open challenges to connect the fundamentals of data-causal-discovery-based science to ecosystem sustainability?
\begin{itemize}
\item {\bf Time-dependent patterns and processes}: Ecosystem dynamics and therefore ecosystem sustainability greatly vary in space and time. At deep time, ecosystems change in size, number of species, functions, resilience, and more. Yet, the understanding of ecosystem sustainability in deep time is lacking. How does ecosystem sustainability change in space and time? Mention here the connection to macroecology, macroevolution, geodynamics and plate tectonics. Is there a model system to refer to? For example, how did the geodynamics (i.e., the topography of the ocean floor), and sea-level fluctuations alter ecosystem processes in our model system?
\item {\bf Spatiotemporal resolution and heterogeneity of data}: Data come with different resolution and heterogeneity levels within and between fields. Mention here the existing methods to standardize the data and also the existing gaps. How do we rarefy data within and between fields?
\item {\bf Dimensionality}: The availability of data to infer the number of factors driving the observed patterns is usually missing. The problem increases when connecting data from different fields. How can we infer robustly the dimensionality of an ecosystem? And how does dimensionality affect sustainability?    
\item {\bf Eco-evolutionary feedbacks}: There are many theoretical and empirical studies showing that changes in the ecological biotic or abiotic factors alter the frequency of phenotypes within populations from small to large organisms. Such fluctuating frequencies of phenotypes are, in some cases, rapidly evolving, and changing the ecological conditions of the ecosystem. This creates a loop between the ecology and the evolution within species, and this might be happening for many species in an ecosystem. How do feedbacks alter the sustainability of an ecosystem? 
\item {\bf Interaction networks}: Many studies have shown the topology of the factors governing the dynamics of species and communities and the structure of the interactions within and between species determine the stability properties of the ecosystem and its capacity to recover or to sustain continuous disturbances
\end{itemize}

We should connect these five points in a coherent framework -- Box 2 is a preliminary draft to do it.
\end{tcolorbox}}


{\small \begin{tcolorbox}[colback=green!5!white,colframe=green!75!black]
  \textbf{Box 2: Eco-evolutionary diversification algorithms in computational sustainability}\\
We validate our framework in Box 1 with a case study focusing on the sustainability of the ocean in federated networks, where many heterogeneous groups of species, humans, and technologies coexist exploiting resources in complex ecosystems.  Also, we aim to connect novel computational sustainability approaches to fully reproducible open-source software solutions of a science-enabled technology to connect knowledge-inspired societies to global sustainability challenges. In our model system, international programs for exploration of the oceans involve many countries collecting biodiversity data using different protocols and technologies (\cite{ices}). The data is then used to understand the spatiotemporal dynamics of the ecological communities as a baseline to inform the status of the ecosystems and fisheries. Each country collects data with different technology, i.e., gear systems, mostly driven by its commercial interests in specific species. This results in countries collecting heterogeneous and biased data about the same species, making it difficult to obtain accurate distribution maps of species (Figure 2). 

This is a tragedy of commons situation \cite{Hardin1968,Ostrom1990,Ecoffet2020} in the context of evolving ecosystems \cite{Rankinetal2007}: Many heterogeneous nodes (i.e., countries with different interests, groups, funding and conservation strategies, etc) exploit resources (i.e., species within ecosystems composed by a network of interacting species) using different technologies (i.e., gear systems and others technologies). Many of these ecosystems are overexploited. And yet, science-based technologies, providing forecasting scenarios and accounting for biased biodiversity data (i.e., species and environment), technologies (i.e., gear systems and other), and human groups with different interest within and between countries, to mitigate risks and enhance global cooperation scenarios in such multidimensional ecosystems are not in place. 

How do we account for diversifying technologies, species and human behaviours? For example, a social group represents a set of actors with multiple traits. In this context, groups are represented with evolving environmental and technological traits. We can formally describe these features as a distribution-fishery cooperation-competition matrix,
  $\mathcal{C}^{2}$, as follows:
  \vspace{-0.20 in}\\
\begin{center}
  $\mathcal{C}^2$ = \bordermatrix{~ &
    $\mathcal{F}^{i}_{\mathcal{A}_{g},\mathcal{B}_{g}}(c)$ &
    $\mathcal{F}^{i}_{\mathcal{A}_{g},\mathcal{B}_{g}}(nc)$ \cr
    $\mathcal{D}^{i}_{\mathcal{A}_{g},\mathcal{B}_{g}}(c)$ &
    $c(\varphi)$ & $c(\Phi), nc(\gamma_{A_{g}},\gamma_{B_{g}})$ \cr
    $\mathcal{D}^{i}_{\mathcal{A}_{g},\mathcal{B}_{g}}(nc)$ &
    $nc(\Phi_{A_{g}},\Phi_{B_{g}}), c(\gamma)$ &
    $nc(\phi_{A_{g}},\phi_{B_{g}})$ \cr}, 
    \vspace{-0.05 in}
\end{center}
where $\mathcal{D}^{i}_{\mathcal{A}_{g},\mathcal{B}_{g}}$, $\mathcal{F}^{i}_{\mathcal{A}_{g},\mathcal{B}_{g}}$ represent respectively the distribution map and fishery of species $i$, group $g$ within countries $\mathcal{A}$ and $\mathcal{B}$, and $c$ and $nc$ refer to cooperation and non-cooperation, respectively. The evolutionary diversification-inspired functions represent environmental and technological traits with different degrees of complexity in the $\mathcal{C}^2$ matrix: If the two groups within or between the countries cooperate, $c(\varphi)$, then the environmental and technological rate change, $\varphi$, is synchronized between groups to evolve towards decreasing Gear bias and make distribution maps and the fishery sustainable, assuming information as the only limitation for sustainable resource exploitation. This can be called the neutral scenario. On the other side, if the two groups decide not to cooperate, $nc(\phi_{A_{g}},\phi_{B_{g}})$, then the environmental and technological rate changes are given by $\phi_{A_{g}}$ and
$\phi_{B_{g}}$ respectively with each group following changes of their own gears, i.e., the GOV for the Ireland group and the Baka Gear for Spain group,
independently of the other and as a function of their fishery interest. There is no interest in decreasing bias in species distribution maps making fishery potentially non-sustainable in this case. In the last two scenarios groups enter in cooperation for the distribution
map of species $i$, but not in the fishery ($c(\Phi), nc(\gamma_{A_{g}},\gamma_{B_{g}})$), or they do cooperate in the fishery for species $i$ but not for the distribution map of species $i$ ($nc(\Phi_{A_{g}},\Phi_{B_{g}}), c(\gamma)$). The situation for cooperation in the distribution maps follows agreements between the two groups to technological changes in the Gear but still preserving their GOV and the Baka Gears for fisheries. Our approach explores classes of evolving functions within the cooperation-competition matrix combining them to automated Bayesian graphs ensuring the search, the evaluation of models, trading-off complexity, fitting to the data and quantify resource usage and recovery \citep{Guimera2020,Steinruecken}.
Eco-evolutionary diversification algorithms aid our (naturally-limited) processing capacity of the multiple processes and interactions responsible for the multitude of biodiversity patterns observed today \citep{Hagen2021} and provide us a unique perspective of highly dynamic system in astonishing deep time. Information might include alpha-, beta- and gamma-diversity; topological, genetic and functional diversity or any variations of metrics considering abundances, uniqueness, species interactions, traits and nestedness for example, which change in space and time \citep{Hagen2021, Pont2019}.  
Process based Eco-evolutionary models aid on sustainability by improving casual understanding of evolving complex systems, useful for long term evaluation of distinct management strategies. Moreover, such tools can support recognizing data gaps by requiring highest global homogeneous information, or even guide data collection for informing on past and present biodiversity data, use full for calibrating complex systems and projecting possible scenarios and conservation management strategies. 
These might include the evolutionary mid- and long-term responses of fish populations sizes, traits and genetic diversity to direct and indirect human interventions. 
\end{tcolorbox}}


\newpage
\bibliographystyle{evolution}
\bibliography{Biblio_deepbios}

\end{document}
